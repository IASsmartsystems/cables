<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Manual Reference App</title>
<style>

#lockScreen {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at top, #121826, #0b0f14);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.lock-card {
  background: #121826;
  padding: 40px;
  border-radius: 18px;
  text-align: center;
  border: 1px solid rgba(0,229,255,0.3);
  box-shadow: 0 0 40px rgba(0,229,255,0.2);
  max-width: 320px;
  width: 90%;
}

.lock-card h2 {
  color: #00e5ff;
}

.lock-card input {
  width: 100%;
  padding: 14px;
  margin: 16px 0;
  border-radius: 10px;
  border: none;
}

.lock-card button {
  padding: 12px 24px;
  border-radius: 10px;
  border: 2px solid #00e5ff;
  background: transparent;
  color: #00e5ff;
  cursor: pointer;
}

.lock-card button:hover {
  background: #00e5ff;
  color: #000;
}

#errorMsg {
  color: #ff6b6b;
}

body { font-family: Arial; padding: 10px; }
select, input, button { padding: 8px; margin: 5px 0; width: 100%; }
table { border-collapse: collapse; width: 100%; font-size: 12px; }
th, td { border: 1px solid #ccc; padding: 4px; }
th { background: #eee; }
img { max-width: 100%; margin-top: 10px; }
</style>
</head>
<body>
<div id="lockScreen">
  <div class="lock-card">
    <h2>ðŸ”’ Restricted Access</h2>
    <p id="projectName"></p>
    <input type="password" id="passwordInput" placeholder="Enter password">
    <button onclick="unlock()">Unlock</button>
    <p id="errorMsg"></p>
  </div>
</div>

<h2>Manual Reference</h2>

<h3>Search Anything</h3>
<input id="searchBox" placeholder="Search terminal, wire, tag, description...">
<button onclick="runSearch()">Search</button>

<h3>Browse</h3>
<select id="processSelect" onchange="loadTags()">
  <option value="">Select PROCESS</option>
</select>

<select id="tagSelect" onchange="showBrowseResults()">
  <option value="">Select TAG</option>
</select>

<div id="results"></div>

<script src="app_data.js"></script>

<script>
const data = APP_DATA;

const processSelect = document.getElementById("processSelect");
const tagSelect = document.getElementById("tagSelect");
const resultsDiv = document.getElementById("results");


const PROJECT_NAME = "Cables";
const PASSWORD = "Sentinel2";

document.getElementById("projectName").textContent = PROJECT_NAME;

function unlock() {
  const input = document.getElementById("passwordInput").value;
  if (input === PASSWORD) {
    sessionStorage.setItem("p1_unlocked", "yes");
    document.getElementById("lockScreen").style.display = "none";
  } else {
    document.getElementById("errorMsg").textContent = "Incorrect password";
  }
}

if (sessionStorage.getItem("p1_unlocked") === "yes") {
  document.getElementById("lockScreen").style.display = "none";
}
// Populate PROCESS dropdown
[...new Set(data.map(r => r.PROCESS).filter(p => p))].sort()
  .forEach(p => {
    let opt = document.createElement("option");
    opt.value = p;
    opt.textContent = p;
    processSelect.appendChild(opt);
  });

function loadTags() {
  tagSelect.innerHTML = '<option value="">Select TAG</option>';
  const proc = processSelect.value;
  const tags = [...new Set(data.filter(r => r.PROCESS === proc).map(r => r.TAG))].sort();

  tags.forEach(t => {
    let opt = document.createElement("option");
    opt.value = t;
    opt.textContent = t;
    tagSelect.appendChild(opt);
  });
}

function showBrowseResults() {
  const proc = processSelect.value;
  const tag = tagSelect.value;
  const filtered = data.filter(r => r.PROCESS === proc && r.TAG === tag);
  renderTable(filtered);
}

function runSearch() {
  const q = document.getElementById("searchBox").value.toLowerCase();
  const filtered = data.filter(r =>
    Object.values(r).some(v => String(v).toLowerCase().includes(q))
  );
  renderTable(filtered);
}

function renderTable(rows) {
  if (!rows.length) {
    resultsDiv.innerHTML = "<p>No results.</p>";
    return;
  }

  let html = `<table><tr>
    <th>PAGE</th><th>TERMINAL</th><th>CONTACT</th><th>WIRE</th>
    <th>CABLE</th><th>CONNECTION</th><th>POLARITY</th>
    <th>PROCESS</th><th>TAG</th><th>DESCRIPTION</th><th>IMAGE</th>
  </tr>`;

  rows.forEach(r => {
    const page = String(r.PAGE).padStart(2, "0");
    html += `<tr>
      <td>${r.PAGE}</td>
      <td>${r.TERMINAL}</td>
      <td>${r.CONTACT}</td>
      <td>${r.WIRE}</td>
      <td>${r.CABLE}</td>
      <td>${r.CONNECTION}</td>
      <td>${r.POLARITY}</td>
      <td>${r.PROCESS}</td>
      <td>${r.TAG}</td>
      <td>${r.DESCRIPTION}</td>
      <td><button onclick="showImage('${page}')">Show</button></td>
    </tr>`;
  });

  html += "</table>";
  resultsDiv.innerHTML = html;
}

function showImage(page) {
  const img = `<h3>Page ${page}</h3><img src="../images/${page}.jpg">`;
  resultsDiv.innerHTML += img;
}
</script>

</body>
</html>
