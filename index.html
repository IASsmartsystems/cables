<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manual Reference App</title>
<style>

#lockScreen {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at top, #121826, #0b0f14);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.lock-card {
  background: #121826;
  padding: 40px;
  border-radius: 18px;
  text-align: center;
  border: 1px solid rgba(0,229,255,0.3);
  box-shadow: 0 0 40px rgba(0,229,255,0.2);
  max-width: 320px;
  width: 90%;
}

.lock-card h2 {
  color: #00e5ff;
}

.lock-card input {
  width: 100%;
  padding: 14px;
  margin: 16px 0;
  border-radius: 10px;
  border: none;
}

.lock-card button {
  padding: 12px 24px;
  border-radius: 10px;
  border: 2px solid #00e5ff;
  background: transparent;
  color: #00e5ff;
  cursor: pointer;
}

.lock-card button:hover {
  background: #00e5ff;
  color: #000;
}

#errorMsg {
  color: #ff6b6b;
}

body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 12px;
  background: #0b0f14;
  color: #e6f1ff;
}

h2, h3 {
  margin-top: 10px;
}

input, select, button {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border-radius: 10px;
  border: none;
  font-size: 16px; /* prevents iOS zoom */
}

button {
  background: #00e5ff;
  color: #000;
  font-weight: bold;
}

button:hover {
  opacity: 0.9;
}
.table-wrap {
  overflow-x: auto;
  margin-top: 10px;
}

table {
  width: 100%;
  border-collapse: collapse;
  min-width: 900px;
  font-size: 12px;
}

th, td {
  padding: 6px;
  border: 1px solid #2a2f3a;
}

th {
  background: #121826;
  position: sticky;
  top: 0;
}

img { 
  max-width: 100%; 
  border-radius: 12px; 
  margin-top: 10px; 
}

.lock-card {
  max-width: 340px;
  width: 95%;
}

@media (min-width: 768px) {
  body {
    max-width: 1100px;
    margin: auto;
  }

  input, select, button {
    max-width: 420px;
  }
}

</style>
</head>
<body>
<div id="lockScreen">
  <div class="lock-card">
    <h2>üîí Restricted Access</h2>
    <p id="projectName"></p>
    <div style="position: relative;">
  <input type="password" id="passwordInput" placeholder="Enter password">
  <span onclick="togglePassword()" 
        style="position:absolute; right:14px; top:50%; transform:translateY(-50%); cursor:pointer;">
    üëÅÔ∏è
  </span>
</div>

    <button onclick="unlock()">Unlock</button>
    <p id="errorMsg"></p>
  </div>
</div>

<h2>Manual Reference</h2>

<h3>Search Anything</h3>
<input id="searchBox" placeholder="Search terminal, wire, tag, description...">
<button onclick="runSearch()">Search</button>

<h3>Browse</h3>
<select id="processSelect" onchange="loadTags()">
  <option value="">Select PROCESS</option>
</select>

<select id="tagSelect" onchange="showBrowseResults()">
  <option value="">Select TAG</option>
</select>

<div id="results"></div>

<script src="app_data.js"></script>

<script>
const data = APP_DATA;

const processSelect = document.getElementById("processSelect");
const tagSelect = document.getElementById("tagSelect");
const resultsDiv = document.getElementById("results");


const PROJECT_NAME = "Cables";
const PASSWORD = "Sentinel2";

document.getElementById("projectName").textContent = PROJECT_NAME;

function unlock() {
  const input = document.getElementById("passwordInput").value;
  if (input === PASSWORD) {
    sessionStorage.setItem("p2_unlocked", "yes");
    document.getElementById("lockScreen").style.display = "none";
  } else {
    document.getElementById("errorMsg").textContent = "Incorrect password";
  }
}

function togglePassword() {
  const input = document.getElementById("passwordInput");
  input.type = input.type === "password" ? "text" : "password";
}

if (sessionStorage.getItem("p2_unlocked") === "yes") {
  document.getElementById("lockScreen").style.display = "none";
}
// Populate PROCESS dropdown
[...new Set(data.map(r => r.PROCESS).filter(p => p))].sort()
  .forEach(p => {
    let opt = document.createElement("option");
    opt.value = p;
    opt.textContent = p;
    processSelect.appendChild(opt);
  });

function loadTags() {
  tagSelect.innerHTML = '<option value="">Select TAG</option>';
  const proc = processSelect.value;
  const tags = [...new Set(data.filter(r => r.PROCESS === proc).map(r => r.TAG))].sort();

  tags.forEach(t => {
    let opt = document.createElement("option");
    opt.value = t;
    opt.textContent = t;
    tagSelect.appendChild(opt);
  });
}

function showBrowseResults() {
  const proc = processSelect.value;
  const tag = tagSelect.value;
  const filtered = data.filter(r => r.PROCESS === proc && r.TAG === tag);
  renderTable(filtered);
}

function runSearch() {
  const q = document.getElementById("searchBox").value.toLowerCase();
  const filtered = data.filter(r =>
    Object.values(r).some(v => String(v).toLowerCase().includes(q))
  );
  renderTable(filtered);
}

function renderTable(rows) {
  if (!rows.length) {
    resultsDiv.innerHTML = "<p>No results.</p>";
    return;
  }

  let html = `<div class="table-wrap"><table><tr>
    <th>PAGE</th><th>TERMINAL</th><th>CONTACT</th><th>WIRE</th>
    <th>CABLE</th><th>CONNECTION</th><th>POLARITY</th>
    <th>PROCESS</th><th>TAG</th><th>DESCRIPTION</th><th>IMAGE</th>
  </tr>`;

  rows.forEach(r => {
    const page = String(r.PAGE).trim().padStart(2, "0");
    html += `<tr>
      <td>${r.PAGE}</td>
      <td>${r.TERMINAL}</td>
      <td>${r.CONTACT}</td>
      <td>${r.WIRE}</td>
      <td>${r.CABLE}</td>
      <td>${r.CONNECTION}</td>
      <td>${r.POLARITY}</td>
      <td>${r.PROCESS}</td>
      <td>${r.TAG}</td>
      <td>${r.DESCRIPTION || r.Description || r["DESCRIPTION "] || ""}</td>
      <td><button onclick="showImage('${page}')">Show</button></td>
    </tr>`;
  });

  html += "</table></div>";
  resultsDiv.innerHTML = html;
}

function showImage(page) {
  const imgPath = `/cables/images/${page}.jpg`;

  const html = `
    <div style="margin-top:15px">
      <h3>Page ${page}</h3>
      <img src="${imgPath}"
           loading="lazy"
           onerror="this.outerHTML='<p style=color:red>Image not found: ${imgPath}</p>'">
    </div>
  `;

  resultsDiv.innerHTML += html;
}


</script>

</body>
</html>


